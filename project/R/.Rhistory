init.adapt=TRUE)
library(slam)
library(maptpx)
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
K <- 3
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=2, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 2
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
warnings()
source('~/Documents/maptpx/R/tpx.R')
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=2, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=2, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=2, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 2
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=2, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 2
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=3, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 3
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=FALSE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=FALSE,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
source('~/Documents/maptpx/R/tpx.R')
source('~/Documents/maptpx/R/topics.R')
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=0,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
for (i in 1:20){
rand_counts <- counts[,sample(ncol(counts), replace=FALSE)]
topics.4 <- topics(rand_counts, K=4, tol=0.000001, kill=0, bf=T, light=0,
init.adapt=TRUE)
docweights <- topics.4$omega
east_west_elevation = paste0(metadata$WorE, "_", metadata$Elevation);
K <- 4
index1 <- which(metadata$WorE=="E");
index2 <- which(metadata$WorE=="W");
elevation1 <- metadata$Elevation[index1]; elevation2 <- metadata$Elevation[index2];
index_WE <- c(index1[order(elevation1)], index2[order(elevation2)]);
barplot(t(docweights[index_WE,]),col=2:(K+1),axisnames=F,space=0,border=NA,main=paste("No. of clusters=",K),las=1,ylim=c(0,1),cex.axis=1.5,cex.main=1.4)
combo_patch_dir = paste0(east_west_elevation);
combo_patch_dir_ordered = combo_patch_dir[index_WE];
match_labs=match(unique(combo_patch_dir_ordered),combo_patch_dir_ordered);
match_labs_suffix=c(match_labs[2:length(unique(combo_patch_dir_ordered))],35);
match_labs_prefix=match_labs[1:(length(unique(combo_patch_dir_ordered)))];
labs=match_labs_prefix + 0.5*(match_labs_suffix - match_labs_prefix);
axis(1,at=labs,unique(combo_patch_dir_ordered),las=2);
abline(v=match_labs[2:length(match_labs)]);
}
